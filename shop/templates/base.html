{% load static %}
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}OnGoShop{% endblock %}</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@1.0.2/css/bulma.min.css">
  <style>
    :root {
      --magenta: #8b5cf6;
      --magenta-hover: #7c3aed;
      --dark-bg: #121212;
      --dark-text: #f3f3f3;
      --light-bg: #ffffff;
      --light-text: #1e1e1e;
    }

    body {
      transition: all 0.3s ease;
    }

    body.dark {
      background-color: var(--dark-bg);
      color: var(--dark-text);
    }

    body.light {
      background-color: var(--light-bg);
      color: var(--light-text);
    }

    .navbar {
      transition: background-color 0.3s ease, color 0.3s ease;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
    }

    .navbar.dark {
      background-color: #1c1c1c;
    }

    .navbar.light {
      background-color: #f9f9f9;
    }

    .navbar-item,
    .navbar-link {
      font-weight: 500;
      transition: color 0.3s ease;
    }

    body.dark .navbar-item,
    body.dark .navbar-link,
    body.dark .navbar-brand span {
      color: var(--dark-text) !important;
    }

    body.light .navbar-item,
    body.light .navbar-link,
    body.light .navbar-brand span {
      color: var(--light-text) !important;
    }

    .button.is-magenta {
      background-color: var(--magenta);
      color: white;
      border: none;
      transition: background 0.2s ease;
    }

    .button.is-magenta:hover {
      background-color: var(--magenta-hover);
    }

    .icon-btn {
      background: none;
      border: none;
      cursor: pointer;
      color: inherit;
      transition: background 0.2s ease;
      border-radius: 8px;
      padding: 6px;
    }

    .icon-btn:hover {
      background-color: rgba(0, 0, 0, 0.05);
    }

    .navbar .input {
      max-width: 400px;
      min-width: 250px;
      font-size: 0.95rem;
      transition: all 0.2s ease;
    }
    .navbar .input:focus {
      border-color: var(--magenta);
      box-shadow: 0 0 0 0.15rem rgba(139, 92, 246, 0.3);
    }

    .cart-badge {
      position: absolute;
      top: -4px;
      right: -6px;
      background-color: #ef4444;
      color: white;
      font-size: 0.7rem;
      font-weight: bold;
      border-radius: 50%;
      width: 18px;
      height: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    footer.footer {
      background-color: transparent;
      color: gray;
    }
  </style>
</head>
<body class="dark">
    <nav id="navbar" class="navbar dark is-fixed-top px-5" role="navigation">
    <div class="navbar-brand">
      <a class="navbar-item" href="{% url 'shop:product_list' %}">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" id="logoIcon" class="bi bi-bag-check-fill" viewBox="0 0 16 16">
          <path d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4a.75.75 0 0 1-1.08 0l-2-2a.75.75 0 0 1 1.08-1.04L8 8.94l2.97-2.97z"/>
          <path d="M8 1a2.5 2.5 0 0 1 2.5 2.5V4H13a1 1 0 0 1 1 1v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a1 1 0 0 1 1-1h2.5v-.5A2.5 2.5 0 0 1 8 1z"/>
        </svg>
        <span class="ml-2 has-text-weight-bold">OnGoShop</span>
      </a>
    </div>

    <div class="navbar-menu is-flex is-align-items-center" style="width: 100%; justify-content: space-between;">
      
      <div class="navbar-start is-flex is-align-items-center">
        <a class="navbar-item" href="{% url 'shop:product_list' %}">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a>
      </div>

      <div class="navbar-item is-flex is-justify-content-center" style="flex-grow: 1;">
        <form method="get" action="{% url 'shop:product_list' %}" class="is-flex is-justify-content-center" style="width: 100%;">
          <div class="control has-icons-left" style="max-width: 380px; width: 100%;">
            <input 
              class="input is-rounded" 
              type="search" 
              name="q" 
              value="{{ request.GET.q }}" 
              placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤..."
              onkeypress="if(event.key === 'Enter'){ this.form.submit(); }">
            <span class="icon is-left">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001l3.85 3.85a1 1 0 0 0 1.415-1.415l-3.85-3.85zm-5.242 1.656a5.5 5.5 0 1 1 0-11 5.5 5.5 0 0 1 0 11z"/>
              </svg>
            </span>
          </div>
        </form>
      </div>

      <div class="navbar-end is-flex is-align-items-center" style="gap: 1rem; margin-right: 0.5rem;">

        {% if user.is_authenticated %}
          <div class="navbar-item" style="position: relative;">
            <a href="{% url 'shop:cart' %}" class="icon-btn" title="‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤">
              <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" class="bi bi-cart3">
                <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .49.598l-1 5a.5.5 0 0 1-.465.401l-9.397.472L4.415 11H13a.5.5 0 0 1 0 1H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5M3.102 4l.84 4.479 9.144-.459L13.89 4z"/>
              </svg>
              {% if cart_count > 0 %}
              <span class="cart-badge">{{ cart_count }}</span>
              {% endif %}
            </a>
          </div>

          <!-- üë§ Profile -->
          <div class="navbar-item has-dropdown is-hoverable">
            <a class="navbar-link icon-btn" style="border-radius: 50%;">
              <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" class="bi bi-person-circle">
                <path d="M11 10a2 2 0 1 0-4 0 2 2 0 0 0 4 0z"/>
                <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-4.9 11.9c.03-.32.07-.64.12-.96.22-1.5 1.46-2.68 2.97-2.93A3.993 3.993 0 0 1 8 7c1.05 0 2.01.4 2.74 1.05a3.01 3.01 0 0 1 2.9 2.38c.05.32.09.64.12.96A7 7 0 0 0 8 1z"/>
              </svg>
            </a>
            <div class="navbar-dropdown is-right">
              <a class="navbar-item" href="{% url 'shop:my_orders' %}">‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</a>
              {% if user.is_staff %}
              <a class="navbar-item" href="{% url 'shop:admin_product_list' %}">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</a>
              {% endif %}
              <hr class="navbar-divider">
              <a class="navbar-item has-text-danger" href="{% url 'shop:logout' %}">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</a>
            </div>
          </div>

        {% else %}
          <div class="navbar-item">
            <a class="button is-light" href="{% url 'shop:login' %}">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</a>
          </div>
          <div class="navbar-item">
            <a class="button is-magenta" href="{% url 'shop:register' %}">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</a>
          </div>
        {% endif %}

        <div class="navbar-item">
          <button id="themeToggle" class="icon-btn" title="Toggle Theme">
            <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-moon">
              <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46 7.21 7.21 0 0 0 .878 3.46.768.768 0 0 1-.08.858 8.006 8.006 0 1 1 0-8.636z"/>
            </svg>
            <svg id="sun" style="display:none" xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-sun">
              <path d="M8 4.5a3.5 3.5 0 1 0 0 7 3.5 3.5 0 0 0 0-7zm0 8a4.5 4.5 0 1 1 0-9 4.5 4.5 0 0 1 0 9z"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </nav>


  <section class="section mt-6">
    <div class="container">
      {% block content %}{% endblock %}
    </div>
  </section>

  <footer class="footer has-text-centered">
    <p>¬© 2025 OnGoShop ‚Äî ‡∏£‡∏∞‡∏ö‡∏ö E-commerce</p>
  </footer>

  <script>
    const toggle = document.getElementById("themeToggle");
    const body = document.body;
    const navbar = document.getElementById("navbar");
    const logoIcon = document.getElementById("logoIcon");
    const moon = document.getElementById("moon");
    const sun = document.getElementById("sun");

    toggle.addEventListener("click", () => {
      const isDark = body.classList.contains("dark");
      body.classList.toggle("dark", !isDark);
      body.classList.toggle("light", isDark);
      navbar.classList.toggle("dark", !isDark);
      navbar.classList.toggle("light", isDark);
      moon.style.display = isDark ? "inline" : "none";
      sun.style.display = isDark ? "none" : "inline";
      logoIcon.setAttribute("fill", isDark ? "#000" : "#fff");
    });
  </script>
</body>
</html>
