{% extends 'base.html' %}
{% block title %}‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î | OnGoShop{% endblock %}
{% block content %}
<h1 class="title">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h1>

<!-- üîç ‡πÅ‡∏ñ‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ + ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö -->
<form method="get" action="{% url 'shop:product_list' %}" class="mb-5">
  <div class="columns is-vcentered">
    <div class="column is-4">
      <input class="input" type="search" name="q" value="{{ request.GET.q }}" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤...">
    </div>
    <div class="column is-3">
      <div class="select is-fullwidth">
        <select name="sort" onchange="this.form.submit()">
          <option value="">-- ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏° --</option>
          <option value="price_low" {% if request.GET.sort == 'price_low' %}selected{% endif %}>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î</option>
          <option value="price_high" {% if request.GET.sort == 'price_high' %}selected{% endif %}>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</option>
          <option value="newest" {% if request.GET.sort == 'newest' %}selected{% endif %}>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</option>
          <option value="oldest" {% if request.GET.sort == 'oldest' %}selected{% endif %}>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</option>
        </select>
      </div>
    </div>
    <div class="column">
      <button class="button is-link">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
    </div>
  </div>
</form>

{% if products %}
  <div class="columns is-multiline">
    {% for p in products %}
      <div class="column is-one-quarter">
        <div class="card">
          <div class="card-image">
            <figure class="image is-4by3">
              <img src="{{ p.image_url|default:'/static/shop/img/placeholder.png' }}" alt="{{ p.name }}">
            </figure>
          </div>
          <div class="card-content">
            <p class="title is-6">{{ p.name }}</p>
            <p class="subtitle is-6 has-text-link">{{ p.price }} ‡∏ø</p>

            <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ -->
            <form action="{% url 'shop:add_to_cart' %}" method="POST">
              {% csrf_token %}
              <input type="hidden" name="product_id" value="{{ p.id }}">
              <div class="field has-addons">
                <div class="control is-expanded">
                  <input class="input" type="number" name="quantity" value="1" min="1">
                </div>
                <div class="control">
                  <button type="submit" class="button is-link is-light">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
                </div>
              </div>
            </form>

            <a href="{% url 'shop:product_detail' p.id %}" class="button is-small is-info is-light mt-2">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</a>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <div class="notification is-warning">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</div>
{% endif %}
{% endblock %}
